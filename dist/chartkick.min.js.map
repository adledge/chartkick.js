{"version":3,"file":"chartkick.min.js","sources":["../src/helpers.js","../src/adapters/chartjs.js","../src/adapters/highcharts.js","../src/adapters/google.js","../src/request-queue.js","../src/index.js"],"sourcesContent":["function isArray(variable) {\n  return Object.prototype.toString.call(variable) === \"[object Array]\";\n}\n\nfunction isFunction(variable) {\n  return variable instanceof Function;\n}\n\nfunction isPlainObject(variable) {\n  return !isFunction(variable) && variable instanceof Object;\n}\n\n// https://github.com/madrobby/zepto/blob/master/src/zepto.js\nfunction extend(target, source) {\n  let key;\n  for (key in source) {\n    if (isPlainObject(source[key]) || isArray(source[key])) {\n      if (isPlainObject(source[key]) && !isPlainObject(target[key])) {\n        target[key] = {};\n      }\n      if (isArray(source[key]) && !isArray(target[key])) {\n        target[key] = [];\n      }\n      extend(target[key], source[key]);\n    } else if (source[key] !== undefined) {\n      target[key] = source[key];\n    }\n  }\n}\n\nfunction merge(obj1, obj2) {\n  let target = {};\n  extend(target, obj1);\n  extend(target, obj2);\n  return target;\n}\n\nlet DATE_PATTERN = /^(\\d\\d\\d\\d)(-)?(\\d\\d)(-)?(\\d\\d)$/i;\n\n// https://github.com/Do/iso8601.js\nlet ISO8601_PATTERN = /(\\d\\d\\d\\d)(-)?(\\d\\d)(-)?(\\d\\d)(T)?(\\d\\d)(:)?(\\d\\d)?(:)?(\\d\\d)?([.,]\\d+)?($|Z|([+-])(\\d\\d)(:)?(\\d\\d)?)/i;\nlet DECIMAL_SEPARATOR = String(1.5).charAt(1);\n\nfunction parseISO8601(input) {\n  let day, hour, matches, milliseconds, minutes, month, offset, result, seconds, type, year;\n  type = Object.prototype.toString.call(input);\n  if (type === \"[object Date]\") {\n    return input;\n  }\n  if (type !== \"[object String]\") {\n    return;\n  }\n  matches = input.match(ISO8601_PATTERN);\n  if (matches) {\n    year = parseInt(matches[1], 10);\n    month = parseInt(matches[3], 10) - 1;\n    day = parseInt(matches[5], 10);\n    hour = parseInt(matches[7], 10);\n    minutes = matches[9] ? parseInt(matches[9], 10) : 0;\n    seconds = matches[11] ? parseInt(matches[11], 10) : 0;\n    milliseconds = matches[12] ? parseFloat(DECIMAL_SEPARATOR + matches[12].slice(1)) * 1000 : 0;\n    result = Date.UTC(year, month, day, hour, minutes, seconds, milliseconds);\n    if (matches[13] && matches[14]) {\n      offset = matches[15] * 60;\n      if (matches[17]) {\n        offset += parseInt(matches[17], 10);\n      }\n      offset *= matches[14] === \"-\" ? -1 : 1;\n      result -= offset * 60 * 1000;\n    }\n    return new Date(result);\n  }\n}\n// end iso8601.js\n\nfunction negativeValues(series) {\n  let i, j, data;\n  for (i = 0; i < series.length; i++) {\n    data = series[i].data;\n    for (j = 0; j < data.length; j++) {\n      if (data[j][1] < 0) {\n        return true;\n      }\n    }\n  }\n  return false;\n}\n\nfunction toStr(n) {\n  return \"\" + n;\n}\n\nfunction toFloat(n) {\n  return parseFloat(n);\n}\n\nfunction toDate(n) {\n  let matches, year, month, day;\n  if (typeof n !== \"object\") {\n    if (typeof n === \"number\") {\n      n = new Date(n * 1000); // ms\n    } else {\n      n = toStr(n);\n      if ((matches = n.match(DATE_PATTERN))) {\n      year = parseInt(matches[1], 10);\n      month = parseInt(matches[3], 10) - 1;\n      day = parseInt(matches[5], 10);\n      return new Date(year, month, day);\n      } else { // str\n        // try our best to get the str into iso8601\n        // TODO be smarter about this\n        let str = n.replace(/ /, \"T\").replace(\" \", \"\").replace(\"UTC\", \"Z\");\n        n = parseISO8601(str) || new Date(n);\n      }\n    }\n  }\n  return n;\n}\n\nfunction toArr(n) {\n  if (!isArray(n)) {\n    let arr = [], i;\n    for (i in n) {\n      if (n.hasOwnProperty(i)) {\n        arr.push([i, n[i]]);\n      }\n    }\n    n = arr;\n  }\n  return n;\n}\n\nfunction jsOptionsFunc(defaultOptions, hideLegend, setTitle, setMin, setMax, setStacked, setXtitle, setYtitle) {\n  return function (chart, opts, chartOptions) {\n    let series = chart.data;\n    let options = merge({}, defaultOptions);\n    options = merge(options, chartOptions || {});\n\n    if (chart.hideLegend || \"legend\" in opts) {\n      hideLegend(options, opts.legend, chart.hideLegend);\n    }\n\n    if (opts.title) {\n      setTitle(options, opts.title);\n    }\n\n    // min\n    if (\"min\" in opts) {\n      setMin(options, opts.min);\n    } else if (!negativeValues(series)) {\n      setMin(options, 0);\n    }\n\n    // max\n    if (opts.max) {\n      setMax(options, opts.max);\n    }\n\n    if (\"stacked\" in opts) {\n      setStacked(options, opts.stacked);\n    }\n\n    if (opts.colors) {\n      options.colors = opts.colors;\n    }\n\n    if (opts.xtitle) {\n      setXtitle(options, opts.xtitle);\n    }\n\n    if (opts.ytitle) {\n      setYtitle(options, opts.ytitle);\n    }\n\n    // merge library last\n    options = merge(options, opts.library || {});\n\n    return options;\n  };\n}\n\nfunction sortByTime(a, b) {\n  return a[0].getTime() - b[0].getTime();\n}\n\nfunction sortByNumberSeries(a, b) {\n  return a[0] - b[0];\n}\n\nfunction sortByNumber(a, b) {\n  return a - b;\n}\n\nfunction isMinute(d) {\n  return d.getMilliseconds() === 0 && d.getSeconds() === 0;\n}\n\nfunction isHour(d) {\n  return isMinute(d) && d.getMinutes() === 0;\n}\n\nfunction isDay(d) {\n  return isHour(d) && d.getHours() === 0;\n}\n\nfunction isWeek(d, dayOfWeek) {\n  return isDay(d) && d.getDay() === dayOfWeek;\n}\n\nfunction isMonth(d) {\n  return isDay(d) && d.getDate() === 1;\n}\n\nfunction isYear(d) {\n  return isMonth(d) && d.getMonth() === 0;\n}\n\nfunction isDate(obj) {\n  return !isNaN(toDate(obj)) && toStr(obj).length >= 6;\n}\n\nfunction formatValue(pre, value, options) {\n  pre = pre || \"\";\n  if (options.prefix) {\n    if (value < 0) {\n      value = value * -1;\n      pre += \"-\";\n    }\n    pre += options.prefix;\n  }\n\n  if (options.thousands || options.decimal) {\n    value = toStr(value);\n    let parts = value.split(\".\");\n    value = parts[0];\n    if (options.thousands) {\n      value = value.replace(/\\B(?=(\\d{3})+(?!\\d))/g, options.thousands);\n    }\n    if (parts.length > 1) {\n      value += (options.decimal || \".\") + parts[1];\n    }\n  }\n\n  return pre + value + (options.suffix || \"\");\n}\n\nexport { formatValue, jsOptionsFunc, merge, isArray, isFunction, toStr, toFloat, toDate, toArr, sortByTime, sortByNumberSeries, sortByNumber, isMinute, isHour, isDay, isWeek, isMonth, isYear, isDate };\n","import { formatValue, jsOptionsFunc, merge, isArray, toStr, toFloat, sortByNumber, isMinute, isHour, isDay, isWeek, isMonth, isYear } from \"../helpers\";\n\nfunction allZeros(data) {\n  let i, j, d;\n  for (i = 0; i < data.length; i++) {\n    d = data[i].data;\n    for (j = 0; j < d.length; j++) {\n      if (d[j][1] != 0) {\n        return false;\n      }\n    }\n  }\n  return true;\n}\n\nlet baseOptions = {\n  maintainAspectRatio: false,\n  animation: false,\n  tooltips: {\n    displayColors: false,\n    callbacks: {}\n  },\n  legend: {},\n  title: {fontSize: 20, fontColor: \"#333\"}\n};\n\nlet defaultOptions = {\n  scales: {\n    yAxes: [\n      {\n        ticks: {\n          maxTicksLimit: 4\n        },\n        scaleLabel: {\n          fontSize: 16,\n          // fontStyle: \"bold\",\n          fontColor: \"#333\"\n        }\n      }\n    ],\n    xAxes: [\n      {\n        gridLines: {\n          drawOnChartArea: false\n        },\n        scaleLabel: {\n          fontSize: 16,\n          // fontStyle: \"bold\",\n          fontColor: \"#333\"\n        },\n        time: {},\n        ticks: {}\n      }\n    ]\n  }\n};\n\n// http://there4.io/2012/05/02/google-chart-color-list/\nlet defaultColors = [\n  \"#3366CC\", \"#DC3912\", \"#FF9900\", \"#109618\", \"#990099\", \"#3B3EAC\", \"#0099C6\",\n  \"#DD4477\", \"#66AA00\", \"#B82E2E\", \"#316395\", \"#994499\", \"#22AA99\", \"#AAAA11\",\n  \"#6633CC\", \"#E67300\", \"#8B0707\", \"#329262\", \"#5574A6\", \"#651067\"\n];\n\nlet hideLegend = function (options, legend, hideLegend) {\n  if (legend !== undefined) {\n    options.legend.display = !!legend;\n    if (legend && legend !== true) {\n      options.legend.position = legend;\n    }\n  } else if (hideLegend) {\n    options.legend.display = false;\n  }\n};\n\nlet setTitle = function (options, title) {\n  options.title.display = true;\n  options.title.text = title;\n};\n\nlet setMin = function (options, min) {\n  if (min !== null) {\n    options.scales.yAxes[0].ticks.min = toFloat(min);\n  }\n};\n\nlet setMax = function (options, max) {\n  options.scales.yAxes[0].ticks.max = toFloat(max);\n};\n\nlet setBarMin = function (options, min) {\n  if (min !== null) {\n    options.scales.xAxes[0].ticks.min = toFloat(min);\n  }\n};\n\nlet setBarMax = function (options, max) {\n  options.scales.xAxes[0].ticks.max = toFloat(max);\n};\n\nlet setStacked = function (options, stacked) {\n  options.scales.xAxes[0].stacked = !!stacked;\n  options.scales.yAxes[0].stacked = !!stacked;\n};\n\nlet setXtitle = function (options, title) {\n  options.scales.xAxes[0].scaleLabel.display = true;\n  options.scales.xAxes[0].scaleLabel.labelString = title;\n};\n\nlet setYtitle = function (options, title) {\n  options.scales.yAxes[0].scaleLabel.display = true;\n  options.scales.yAxes[0].scaleLabel.labelString = title;\n};\n\n// http://stackoverflow.com/questions/5623838/rgb-to-hex-and-hex-to-rgb\nlet addOpacity = function(hex, opacity) {\n  let result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n  return result ? \"rgba(\" + parseInt(result[1], 16) + \", \" + parseInt(result[2], 16) + \", \" + parseInt(result[3], 16) + \", \" + opacity + \")\" : hex;\n};\n\nlet setLabelSize = function (chart, data, options) {\n  let maxLabelSize = Math.ceil(chart.element.offsetWidth / 4.0 / data.labels.length);\n  if (maxLabelSize > 25) {\n    maxLabelSize = 25;\n  }\n  options.scales.xAxes[0].ticks.callback = function (value) {\n    value = toStr(value);\n    if (value.length > maxLabelSize) {\n      return value.substring(0, maxLabelSize - 2) + \"...\";\n    } else {\n      return value;\n    }\n  };\n};\n\nlet setFormatOptions = function(chart, options, chartType) {\n  let formatOptions = {\n    prefix: chart.options.prefix,\n    suffix: chart.options.suffix,\n    thousands: chart.options.thousands,\n    decimal: chart.options.decimal\n  };\n\n  if (formatOptions.prefix || formatOptions.suffix || formatOptions.thousands || formatOptions.decimal) {\n    if (chartType !== \"pie\") {\n      let myAxes = options.scales.yAxes;\n      if (chartType === \"bar\") {\n        myAxes = options.scales.xAxes;\n      }\n\n      if (!myAxes[0].ticks.callback) {\n        myAxes[0].ticks.callback = function (value) {\n          return formatValue(\"\", value, formatOptions);\n        };\n      }\n    }\n\n    if (!options.tooltips.callbacks.label) {\n      if (chartType !== \"pie\") {\n        let valueLabel = chartType === \"bar\" ? \"xLabel\" : \"yLabel\";\n        options.tooltips.callbacks.label = function (tooltipItem, data) {\n          let label = data.datasets[tooltipItem.datasetIndex].label || '';\n          if (label) {\n            label += ': ';\n          }\n          return formatValue(label, tooltipItem[valueLabel], formatOptions);\n        };\n      } else {\n        // need to use separate label for pie charts\n        options.tooltips.callbacks.label = function (tooltipItem, data) {\n          let dataLabel = data.labels[tooltipItem.index];\n          let value = ': ';\n\n          if (isArray(dataLabel)) {\n            // show value on first line of multiline label\n            // need to clone because we are changing the value\n            dataLabel = dataLabel.slice();\n            dataLabel[0] += value;\n          } else {\n            dataLabel += value;\n          }\n\n          return formatValue(dataLabel, data.datasets[tooltipItem.datasetIndex].data[tooltipItem.index], formatOptions);\n        };\n      }\n    }\n  }\n};\n\nlet jsOptions = jsOptionsFunc(merge(baseOptions, defaultOptions), hideLegend, setTitle, setMin, setMax, setStacked, setXtitle, setYtitle);\n\nlet createDataTable = function (chart, options, chartType) {\n  let datasets = [];\n  let labels = [];\n\n  let colors = chart.options.colors || defaultColors;\n\n  let day = true;\n  let week = true;\n  let dayOfWeek;\n  let month = true;\n  let year = true;\n  let hour = true;\n  let minute = true;\n  let detectType = (chartType === \"line\" || chartType === \"area\") && !chart.discrete;\n\n  let series = chart.data;\n\n  let sortedLabels = [];\n\n  let i, j, s, d, key, rows = [];\n  for (i = 0; i < series.length; i++) {\n    s = series[i];\n\n    for (j = 0; j < s.data.length; j++) {\n      d = s.data[j];\n      key = detectType ? d[0].getTime() : d[0];\n      if (!rows[key]) {\n        rows[key] = new Array(series.length);\n      }\n      rows[key][i] = toFloat(d[1]);\n      if (sortedLabels.indexOf(key) === -1) {\n        sortedLabels.push(key);\n      }\n    }\n  }\n\n  if (detectType || chart.options.xtype === \"number\") {\n    sortedLabels.sort(sortByNumber);\n  }\n\n  let rows2 = [];\n  for (j = 0; j < series.length; j++) {\n    rows2.push([]);\n  }\n\n  let value;\n  let k;\n  for (k = 0; k < sortedLabels.length; k++) {\n    i = sortedLabels[k];\n    if (detectType) {\n      value = new Date(toFloat(i));\n      // TODO make this efficient\n      day = day && isDay(value);\n      if (!dayOfWeek) {\n        dayOfWeek = value.getDay();\n      }\n      week = week && isWeek(value, dayOfWeek);\n      month = month && isMonth(value);\n      year = year && isYear(value);\n      hour = hour && isHour(value);\n      minute = minute && isMinute(value);\n    } else {\n      value = i;\n    }\n    labels.push(value);\n    for (j = 0; j < series.length; j++) {\n      // Chart.js doesn't like undefined\n      rows2[j].push(rows[i][j] === undefined ? null : rows[i][j]);\n    }\n  }\n\n  for (i = 0; i < series.length; i++) {\n    s = series[i];\n\n    let color = s.color || colors[i];\n    let backgroundColor = chartType !== \"line\" ? addOpacity(color, 0.5) : color;\n\n    let dataset = {\n      label: s.name,\n      data: rows2[i],\n      fill: chartType === \"area\",\n      borderColor: color,\n      backgroundColor: backgroundColor,\n      pointBackgroundColor: color,\n      pointHoverBackgroundColor: color,\n      borderWidth: 2\n    };\n\n    if (s.stack) {\n      dataset.stack = s.stack;\n    }\n\n    if (chart.options.curve === false) {\n      dataset.lineTension = 0;\n    }\n\n    if (chart.options.points === false) {\n      dataset.pointRadius = 0;\n      dataset.pointHitRadius = 5;\n    }\n\n    dataset = merge(dataset, chart.options.dataset || {});\n    dataset = merge(dataset, s.library || {});\n    dataset = merge(dataset, s.dataset || {});\n\n    datasets.push(dataset);\n  }\n\n  if (detectType && labels.length > 0) {\n    let minTime = labels[0].getTime();\n    let maxTime = labels[0].getTime();\n    for (i = 1; i < labels.length; i++) {\n      value = labels[i].getTime();\n      if (value < minTime) {\n        minTime = value;\n      }\n      if (value > maxTime) {\n        maxTime = value;\n      }\n    }\n\n    let timeDiff = (maxTime - minTime) / (86400 * 1000.0);\n\n    if (!options.scales.xAxes[0].time.unit) {\n      let step;\n      if (year || timeDiff > 365 * 10) {\n        options.scales.xAxes[0].time.unit = \"year\";\n        step = 365;\n      } else if (month || timeDiff > 30 * 10) {\n        options.scales.xAxes[0].time.unit = \"month\";\n        step = 30;\n      } else if (day || timeDiff > 10) {\n        options.scales.xAxes[0].time.unit = \"day\";\n        step = 1;\n      } else if (hour || timeDiff > 0.5) {\n        options.scales.xAxes[0].time.displayFormats = {hour: \"MMM D, h a\"};\n        options.scales.xAxes[0].time.unit = \"hour\";\n        step = 1 / 24.0;\n      } else if (minute) {\n        options.scales.xAxes[0].time.displayFormats = {minute: \"h:mm a\"};\n        options.scales.xAxes[0].time.unit = \"minute\";\n        step = 1 / 24.0 / 60.0;\n      }\n\n      if (step && timeDiff > 0) {\n        let unitStepSize = Math.ceil(timeDiff / step / (chart.element.offsetWidth / 100.0));\n        if (week && step === 1) {\n          unitStepSize = Math.ceil(unitStepSize / 7.0) * 7;\n        }\n        options.scales.xAxes[0].time.unitStepSize = unitStepSize;\n      }\n    }\n\n    if (!options.scales.xAxes[0].time.tooltipFormat) {\n      if (day) {\n        options.scales.xAxes[0].time.tooltipFormat = \"ll\";\n      } else if (hour) {\n        options.scales.xAxes[0].time.tooltipFormat = \"MMM D, h a\";\n      } else if (minute) {\n        options.scales.xAxes[0].time.tooltipFormat = \"h:mm a\";\n      }\n    }\n  }\n\n  let data = {\n    labels: labels,\n    datasets: datasets\n  };\n\n  return data;\n};\n\nexport default class {\n  constructor(library) {\n    this.name = \"chartjs\";\n    this.library = library;\n  }\n\n  renderLineChart(chart, chartType) {\n    if (chart.options.xtype === \"number\") {\n      return this.renderScatterChart(chart, chartType, true);\n    }\n\n    let chartOptions = {};\n    if (chartType === \"area\") {\n      // TODO fix area stacked\n      // chartOptions.stacked = true;\n    }\n    // fix for https://github.com/chartjs/Chart.js/issues/2441\n    if (!chart.options.max && allZeros(chart.data)) {\n      chartOptions.max = 1;\n    }\n\n    let options = jsOptions(chart, merge(chartOptions, chart.options));\n    setFormatOptions(chart, options, chartType);\n\n    let data = createDataTable(chart, options, chartType || \"line\");\n\n    options.scales.xAxes[0].type = chart.discrete ? \"category\" : \"time\";\n\n    this.drawChart(chart, \"line\", data, options);\n  }\n\n  renderPieChart(chart) {\n    let options = merge({}, baseOptions);\n    if (chart.options.donut) {\n      options.cutoutPercentage = 50;\n    }\n\n    if (\"legend\" in chart.options) {\n      hideLegend(options, chart.options.legend);\n    }\n\n    if (chart.options.title) {\n      setTitle(options, chart.options.title);\n    }\n\n    options = merge(options, chart.options.library || {});\n    setFormatOptions(chart, options, \"pie\");\n\n    let labels = [];\n    let values = [];\n    for (let i = 0; i < chart.data.length; i++) {\n      let point = chart.data[i];\n      labels.push(point[0]);\n      values.push(point[1]);\n    }\n\n    let dataset = {\n      data: values,\n      backgroundColor: chart.options.colors || defaultColors\n    };\n    dataset = merge(dataset, chart.options.dataset || {});\n\n    let data = {\n      labels: labels,\n      datasets: [dataset]\n    };\n\n    this.drawChart(chart, \"pie\", data, options);\n  }\n\n  renderColumnChart(chart, chartType) {\n    let options;\n    if (chartType === \"bar\") {\n      options = jsOptionsFunc(merge(baseOptions, defaultOptions), hideLegend, setTitle, setBarMin, setBarMax, setStacked, setXtitle, setYtitle)(chart, chart.options);\n    } else {\n      options = jsOptions(chart, chart.options);\n    }\n    setFormatOptions(chart, options, chartType);\n    let data = createDataTable(chart, options, \"column\");\n    if (chartType !== \"bar\") {\n      setLabelSize(chart, data, options);\n    }\n    this.drawChart(chart, (chartType === \"bar\" ? \"horizontalBar\" : \"bar\"), data, options);\n  }\n\n  renderAreaChart(chart) {\n    this.renderLineChart(chart, \"area\");\n  }\n\n  renderBarChart(chart) {\n    this.renderColumnChart(chart, \"bar\");\n  }\n\n  renderScatterChart(chart, chartType, lineChart) {\n    chartType = chartType || \"line\";\n\n    let options = jsOptions(chart, chart.options);\n    if (!lineChart) {\n      setFormatOptions(chart, options, chartType);\n    }\n\n    let colors = chart.options.colors || defaultColors;\n\n    let datasets = [];\n    let series = chart.data;\n    for (let i = 0; i < series.length; i++) {\n      let s = series[i];\n      let d = [];\n      for (let j = 0; j < s.data.length; j++) {\n        let point = {\n          x: toFloat(s.data[j][0]),\n          y: toFloat(s.data[j][1])\n        };\n        if (chartType === \"bubble\") {\n          point.r = toFloat(s.data[j][2]);\n        }\n        d.push(point);\n      }\n\n      let color = s.color || colors[i];\n      let backgroundColor = chartType === \"area\" ? addOpacity(color, 0.5) : color;\n\n      datasets.push({\n        label: s.name,\n        showLine: lineChart || false,\n        data: d,\n        borderColor: color,\n        backgroundColor: backgroundColor,\n        pointBackgroundColor: color,\n        fill: chartType === \"area\"\n      });\n    }\n\n    if (chartType === \"area\") {\n      chartType = \"line\";\n    }\n\n    let data = {datasets: datasets};\n\n    options.scales.xAxes[0].type = \"linear\";\n    options.scales.xAxes[0].position = \"bottom\";\n\n    this.drawChart(chart, chartType, data, options);\n  }\n\n  renderBubbleChart(chart) {\n    this.renderScatterChart(chart, \"bubble\");\n  }\n\n  renderPolarChart(chart) {\n    let options = merge({}, baseOptions);\n\n    if (\"legend\" in chart.options) {\n      hideLegend(options, chart.options.legend);\n    }\n\n    if (chart.options.title) {\n      setTitle(options, chart.options.title);\n    }\n\n    options = merge(options, chart.options.library || {});\n    setFormatOptions(chart, options, \"polarArea\");\n\n    let labels = [];\n    let values = [];\n    Object.keys(chart.rawData[0]).forEach((point) => {\n      labels.push(point);\n      values.push(chart.rawData[0][point]);\n    });\n\n    let dataset = {\n      data: values,\n      backgroundColor: chart.options.colors || defaultColors\n    };\n    dataset = merge(dataset, chart.options.dataset || {});\n\n    let data = {\n      labels: labels,\n      datasets: [dataset]\n    };\n\n    this.drawChart(chart, \"polarArea\", data, options);\n  }\n\n  destroy(chart) {\n    if (chart.chart) {\n      chart.chart.destroy();\n    }\n  }\n\n  drawChart(chart, type, data, options) {\n    this.destroy(chart);\n\n    let chartOptions = {\n      type: type,\n      data: data,\n      options: options\n    };\n\n    if (chart.options.eject) {\n      chart.element.innerText = \"new Chart(ctx, \" + JSON.stringify(chartOptions) + \");\";\n    } else {\n      chart.element.innerHTML = \"<canvas></canvas>\";\n      let ctx = chart.element.getElementsByTagName(\"CANVAS\")[0];\n      chart.chart = new this.library(ctx, chartOptions);\n    }\n  }\n}\n","import { formatValue, jsOptionsFunc, merge, sortByNumber } from \"../helpers\";\n\nlet defaultOptions = {\n  chart: {},\n  xAxis: {\n    title: {\n      text: null\n    },\n    labels: {\n      style: {\n        fontSize: \"12px\"\n      }\n    }\n  },\n  yAxis: {\n    title: {\n      text: null\n    },\n    labels: {\n      style: {\n        fontSize: \"12px\"\n      }\n    }\n  },\n  title: {\n    text: null\n  },\n  credits: {\n    enabled: false\n  },\n  legend: {\n    borderWidth: 0\n  },\n  tooltip: {\n    style: {\n      fontSize: \"12px\"\n    }\n  },\n  plotOptions: {\n    areaspline: {},\n    series: {\n      marker: {}\n    }\n  }\n};\n\nlet hideLegend = function (options, legend, hideLegend) {\n  if (legend !== undefined) {\n    options.legend.enabled = !!legend;\n    if (legend && legend !== true) {\n      if (legend === \"top\" || legend === \"bottom\") {\n        options.legend.verticalAlign = legend;\n      } else {\n        options.legend.layout = \"vertical\";\n        options.legend.verticalAlign = \"middle\";\n        options.legend.align = legend;\n      }\n    }\n  } else if (hideLegend) {\n    options.legend.enabled = false;\n  }\n};\n\nlet setTitle = function (options, title) {\n  options.title.text = title;\n};\n\nlet setMin = function (options, min) {\n  options.yAxis.min = min;\n};\n\nlet setMax = function (options, max) {\n  options.yAxis.max = max;\n};\n\nlet setStacked = function (options, stacked) {\n  options.plotOptions.series.stacking = stacked ? (stacked === true ? \"normal\" : stacked) : null;\n};\n\nlet setXtitle = function (options, title) {\n  options.xAxis.title.text = title;\n};\n\nlet setYtitle = function (options, title) {\n  options.yAxis.title.text = title;\n};\n\nlet jsOptions = jsOptionsFunc(defaultOptions, hideLegend, setTitle, setMin, setMax, setStacked, setXtitle, setYtitle);\n\nlet setFormatOptions = function(chart, options, chartType) {\n  let formatOptions = {\n    prefix: chart.options.prefix,\n    suffix: chart.options.suffix,\n    thousands: chart.options.thousands,\n    decimal: chart.options.decimal\n  };\n\n  if (formatOptions.prefix || formatOptions.suffix || formatOptions.thousands || formatOptions.decimal) {\n    if (chartType !== \"pie\" && !options.yAxis.labels.formatter) {\n      options.yAxis.labels.formatter = function () {\n        return formatValue(\"\", this.value, formatOptions);\n      };\n    }\n\n    if (!options.tooltip.pointFormatter) {\n      options.tooltip.pointFormatter = function () {\n        return '<span style=\"color:' + this.color + '>\\u25CF</span> ' + formatValue(this.series.name + ': <b>', this.y, formatOptions) + '</b><br/>';\n      };\n    }\n  }\n};\n\nexport default class {\n  constructor(library) {\n    this.name = \"highcharts\";\n    this.library = library;\n  }\n\n  renderLineChart(chart, chartType) {\n    chartType = chartType || \"spline\";\n    let chartOptions = {};\n    if (chartType === \"areaspline\") {\n      chartOptions = {\n        plotOptions: {\n          areaspline: {\n            stacking: \"normal\"\n          },\n          area: {\n            stacking: \"normal\"\n          },\n          series: {\n            marker: {\n              enabled: false\n            }\n          }\n        }\n      };\n    }\n\n    if (chart.options.curve === false) {\n      if (chartType === \"areaspline\") {\n        chartType = \"area\";\n      } else if (chartType === \"spline\") {\n        chartType = \"line\";\n      }\n    }\n\n    let options = jsOptions(chart, chart.options, chartOptions), data, i, j;\n    options.xAxis.type = chart.discrete ? \"category\" : \"datetime\";\n    if (!options.chart.type) {\n      options.chart.type = chartType;\n    }\n    setFormatOptions(chart, options, chartType);\n\n    let series = chart.data;\n    for (i = 0; i < series.length; i++) {\n      data = series[i].data;\n      if (!chart.discrete) {\n        for (j = 0; j < data.length; j++) {\n          data[j][0] = data[j][0].getTime();\n        }\n      }\n      series[i].marker = {symbol: \"circle\"};\n      if (chart.options.points === false) {\n        series[i].marker.enabled = false;\n      }\n    }\n\n    this.drawChart(chart, series, options);\n  }\n\n  renderScatterChart(chart) {\n    let options = jsOptions(chart, chart.options, {});\n    options.chart.type = \"scatter\";\n    this.drawChart(chart, chart.data, options);\n  }\n\n  renderPieChart(chart) {\n    let chartOptions = merge(defaultOptions, {});\n\n    if (chart.options.colors) {\n      chartOptions.colors = chart.options.colors;\n    }\n    if (chart.options.donut) {\n      chartOptions.plotOptions = {pie: {innerSize: \"50%\"}};\n    }\n\n    if (\"legend\" in chart.options) {\n      hideLegend(chartOptions, chart.options.legend);\n    }\n\n    if (chart.options.title) {\n      setTitle(chartOptions, chart.options.title);\n    }\n\n    let options = merge(chartOptions, chart.options.library || {});\n    setFormatOptions(chart, options, \"pie\");\n    let series = [{\n      type: \"pie\",\n      name: chart.options.label || \"Value\",\n      data: chart.data\n    }];\n\n    this.drawChart(chart, series, options);\n  }\n\n  renderColumnChart(chart, chartType) {\n    chartType = chartType || \"column\";\n    let series = chart.data;\n    let options = jsOptions(chart, chart.options), i, j, s, d, rows = [], categories = [];\n    options.chart.type = chartType;\n    setFormatOptions(chart, options, chartType);\n\n    for (i = 0; i < series.length; i++) {\n      s = series[i];\n\n      for (j = 0; j < s.data.length; j++) {\n        d = s.data[j];\n        if (!rows[d[0]]) {\n          rows[d[0]] = new Array(series.length);\n          categories.push(d[0]);\n        }\n        rows[d[0]][i] = d[1];\n      }\n    }\n\n    if (chart.options.xtype === \"number\") {\n      categories.sort(sortByNumber);\n    }\n\n    options.xAxis.categories = categories;\n\n    let newSeries = [], d2;\n    for (i = 0; i < series.length; i++) {\n      d = [];\n      for (j = 0; j < categories.length; j++) {\n        d.push(rows[categories[j]][i] || 0);\n      }\n\n      d2 = {\n        name: series[i].name,\n        data: d\n      };\n      if (series[i].stack) {\n        d2.stack = series[i].stack;\n      }\n\n      newSeries.push(d2);\n    }\n\n    this.drawChart(chart, newSeries, options);\n  }\n\n  renderBarChart(chart) {\n    this.renderColumnChart(chart, \"bar\");\n  }\n\n  renderAreaChart(chart) {\n    this.renderLineChart(chart, \"areaspline\");\n  }\n\n  destroy(chart) {\n    if (chart.chart) {\n      chart.chart.destroy();\n    }\n  }\n\n  drawChart(chart, data, options) {\n    this.destroy(chart);\n\n    options.chart.renderTo = chart.element.id;\n    options.series = data;\n\n    if (chart.options.eject) {\n      chart.element.innerText = \"new Highcharts.Chart(\" + JSON.stringify(options) + \");\";\n    } else {\n      chart.chart = new this.library.Chart(options);\n    }\n  }\n}\n","import { jsOptionsFunc, merge, toStr, toFloat, sortByTime, sortByNumberSeries, isDay } from \"../helpers\";\n\nlet loaded = {};\nlet callbacks = [];\n\n// Set chart options\nlet defaultOptions = {\n  chartArea: {},\n  fontName: \"'Lucida Grande', 'Lucida Sans Unicode', Verdana, Arial, Helvetica, sans-serif\",\n  pointSize: 6,\n  legend: {\n    textStyle: {\n      fontSize: 12,\n      color: \"#444\"\n    },\n    alignment: \"center\",\n    position: \"right\"\n  },\n  curveType: \"function\",\n  hAxis: {\n    textStyle: {\n      color: \"#666\",\n      fontSize: 12\n    },\n    titleTextStyle: {},\n    gridlines: {\n      color: \"transparent\"\n    },\n    baselineColor: \"#ccc\",\n    viewWindow: {}\n  },\n  vAxis: {\n    textStyle: {\n      color: \"#666\",\n      fontSize: 12\n    },\n    titleTextStyle: {},\n    baselineColor: \"#ccc\",\n    viewWindow: {}\n  },\n  tooltip: {\n    textStyle: {\n      color: \"#666\",\n      fontSize: 12\n    }\n  }\n};\n\nlet hideLegend = function (options, legend, hideLegend) {\n  if (legend !== undefined) {\n    let position;\n    if (!legend) {\n      position = \"none\";\n    } else if (legend === true) {\n      position = \"right\";\n    } else {\n      position = legend;\n    }\n    options.legend.position = position;\n  } else if (hideLegend) {\n    options.legend.position = \"none\";\n  }\n};\n\nlet setTitle = function (options, title) {\n  options.title = title;\n  options.titleTextStyle = {color: \"#333\", fontSize: \"20px\"};\n};\n\nlet setMin = function (options, min) {\n  options.vAxis.viewWindow.min = min;\n};\n\nlet setMax = function (options, max) {\n  options.vAxis.viewWindow.max = max;\n};\n\nlet setBarMin = function (options, min) {\n  options.hAxis.viewWindow.min = min;\n};\n\nlet setBarMax = function (options, max) {\n  options.hAxis.viewWindow.max = max;\n};\n\nlet setStacked = function (options, stacked) {\n  options.isStacked = stacked ? stacked : false;\n};\n\nlet setXtitle = function (options, title) {\n  options.hAxis.title = title;\n  options.hAxis.titleTextStyle.italic = false;\n};\n\nlet setYtitle = function (options, title) {\n  options.vAxis.title = title;\n  options.vAxis.titleTextStyle.italic = false;\n};\n\nlet jsOptions = jsOptionsFunc(defaultOptions, hideLegend, setTitle, setMin, setMax, setStacked, setXtitle, setYtitle);\n\nlet resize = function (callback) {\n  if (window.attachEvent) {\n    window.attachEvent(\"onresize\", callback);\n  } else if (window.addEventListener) {\n    window.addEventListener(\"resize\", callback, true);\n  }\n  callback();\n};\n\nexport default class {\n  constructor(library) {\n    this.name = \"google\";\n    this.library = library;\n  }\n\n  renderLineChart(chart) {\n    this.waitForLoaded(chart, () => {\n      let chartOptions = {};\n\n      if (chart.options.curve === false) {\n        chartOptions.curveType = \"none\";\n      }\n\n      if (chart.options.points === false) {\n        chartOptions.pointSize = 0;\n      }\n\n      let options = jsOptions(chart, chart.options, chartOptions);\n      let columnType = chart.discrete ? \"string\" : \"datetime\";\n      if (chart.options.xtype === \"number\") {\n        columnType = \"number\";\n      }\n      let data = this.createDataTable(chart.data, columnType);\n\n      this.drawChart(chart, \"LineChart\", data, options);\n    });\n  }\n\n  renderPieChart(chart) {\n    this.waitForLoaded(chart, () => {\n      let chartOptions = {\n        chartArea: {\n          top: \"10%\",\n          height: \"80%\"\n        },\n        legend: {}\n      };\n      if (chart.options.colors) {\n        chartOptions.colors = chart.options.colors;\n      }\n      if (chart.options.donut) {\n        chartOptions.pieHole = 0.5;\n      }\n      if (\"legend\" in chart.options) {\n        hideLegend(chartOptions, chart.options.legend);\n      }\n      if (chart.options.title) {\n        setTitle(chartOptions, chart.options.title);\n      }\n      let options = merge(merge(defaultOptions, chartOptions), chart.options.library || {});\n\n      let data = new this.library.visualization.DataTable();\n      data.addColumn(\"string\", \"\");\n      data.addColumn(\"number\", \"Value\");\n      data.addRows(chart.data);\n\n      this.drawChart(chart, \"PieChart\", data, options);\n    });\n  }\n\n  renderColumnChart(chart) {\n    this.waitForLoaded(chart, () => {\n      let options = jsOptions(chart, chart.options);\n      let data = this.createDataTable(chart.data, \"string\", chart.options.xtype);\n\n      this.drawChart(chart, \"ColumnChart\", data, options);\n    });\n  }\n\n  renderBarChart(chart) {\n    this.waitForLoaded(chart, () => {\n      let chartOptions = {\n        hAxis: {\n          gridlines: {\n            color: \"#ccc\"\n          }\n        }\n      };\n      let options = jsOptionsFunc(defaultOptions, hideLegend, setTitle, setBarMin, setBarMax, setStacked, setXtitle, setYtitle)(chart, chart.options, chartOptions);\n      let data = this.createDataTable(chart.data, \"string\", chart.options.xtype);\n\n      this.drawChart(chart, \"BarChart\", data, options);\n    });\n  }\n\n  renderAreaChart(chart) {\n    this.waitForLoaded(chart, () => {\n      let chartOptions = {\n        isStacked: true,\n        pointSize: 0,\n        areaOpacity: 0.5\n      };\n\n      let options = jsOptions(chart, chart.options, chartOptions);\n      let columnType = chart.discrete ? \"string\" : \"datetime\";\n      if (chart.options.xtype === \"number\") {\n        columnType = \"number\";\n      }\n      let data = this.createDataTable(chart.data, columnType);\n\n      this.drawChart(chart, \"AreaChart\", data, options);\n    });\n  }\n\n  renderGeoChart(chart) {\n    this.waitForLoaded(chart, () => {\n      let chartOptions = {\n        legend: \"none\",\n        colorAxis: {\n          colors: chart.options.colors || [\"#f6c7b6\", \"#ce502d\"]\n        }\n      };\n      let options = merge(merge(defaultOptions, chartOptions), chart.options.library || {});\n\n      let data = new this.library.visualization.DataTable();\n      data.addColumn(\"string\", \"\");\n      data.addColumn(\"number\", chart.options.label || \"Value\");\n      data.addRows(chart.data);\n\n      this.drawChart(chart, \"GeoChart\", data, options);\n    });\n  }\n\n  renderScatterChart(chart) {\n    this.waitForLoaded(chart, () => {\n      let chartOptions = {};\n      let options = jsOptions(chart, chart.options, chartOptions);\n\n      let series = chart.data, rows2 = [], i, j, data, d;\n      for (i = 0; i < series.length; i++) {\n        d = series[i].data;\n        for (j = 0; j < d.length; j++) {\n          let row = new Array(series.length + 1);\n          row[0] = d[j][0];\n          row[i + 1] = d[j][1];\n          rows2.push(row);\n        }\n      }\n\n      data = new this.library.visualization.DataTable();\n      data.addColumn(\"number\", \"\");\n      for (i = 0; i < series.length; i++) {\n        data.addColumn(\"number\", series[i].name);\n      }\n      data.addRows(rows2);\n\n      this.drawChart(chart, \"ScatterChart\", data, options);\n    });\n  }\n\n  renderTimeline(chart) {\n    this.waitForLoaded(chart, \"timeline\", () => {\n      let chartOptions = {\n        legend: \"none\"\n      };\n\n      if (chart.options.colors) {\n        chartOptions.colors = chart.options.colors;\n      }\n      let options = merge(merge(defaultOptions, chartOptions), chart.options.library || {});\n\n      let data = new this.library.visualization.DataTable();\n      data.addColumn({type: \"string\", id: \"Name\"});\n      data.addColumn({type: \"date\", id: \"Start\"});\n      data.addColumn({type: \"date\", id: \"End\"});\n      data.addRows(chart.data);\n\n      chart.element.style.lineHeight = \"normal\";\n\n      this.drawChart(chart, \"Timeline\", data, options);\n    });\n  }\n\n  renderComboChart(chart) {\n    this.waitForLoaded(chart, () => {\n      let chartOptions = {\n        legend: \"none\",\n        colorAxis: {\n          colors: chart.options.colors || [\"#f6c7b6\", \"#ce502d\"]\n        },\n        vAxes: {\n          0: {\n            viewWindowMode:\"explicit\",\n            gridlines: {color: \"transparent\"},\n          },\n          1: {\n            gridlines: {color: \"transparent\"},\n            viewWindow: {\n              max:100,\n              min:0\n            },\n            format: \"#.#'%'\"\n\n          },\n        },\n        seriesType: \"bars\",\n        series: {\n          0: {\n            targetAxisIndex:0\n          },\n          1:  {\n            targetAxisIndex:1,\n            type: \"line\"\n          },\n        }\n      };\n\n      let options = merge(merge(defaultOptions, chartOptions), chart.options.library || {});      \n      let data = this.library.visualization.arrayToDataTable(chart.data);\n\n      this.drawChart(chart, \"ComboChart\", data, options);\n    });\n  }\n\n  destroy(chart) {\n    if (chart.chart) {\n      chart.chart.clearChart();\n    }\n  }\n\n  drawChart(chart, type, data, options) {\n    this.destroy(chart);\n    \n    if (chart.options.eject) {\n      chart.element.innerText = \"var data = new google.visualization.DataTable(\" + data.toJSON() + \");\\nvar chart = new google.visualization.\" + type + \"(element);\\nchart.draw(data, \" + JSON.stringify(options) + \");\";\n    } else {\n      chart.chart = new this.library.visualization[type](chart.element);\n      resize(function () {\n        chart.chart.draw(data, options);\n      });\n    }\n  }\n\n  waitForLoaded(chart, pack, callback) {\n    if (!callback) {\n      callback = pack;\n      pack = \"corechart\";\n    }\n\n    callbacks.push({pack: pack, callback: callback});\n\n    if (loaded[pack]) {\n      this.runCallbacks();\n    } else {\n      loaded[pack] = true;\n\n      // https://groups.google.com/forum/#!topic/google-visualization-api/fMKJcyA2yyI\n      let loadOptions = {\n        packages: [pack],\n        callback: () => { this.runCallbacks(); }\n      };\n      let config = chart.__config();\n      if (config.language) {\n        loadOptions.language = config.language;\n      }\n      if (pack === \"corechart\" && config.mapsApiKey) {\n        loadOptions.mapsApiKey = config.mapsApiKey;\n      }\n\n      if (this.library.setOnLoadCallback) {\n        this.library.load(\"visualization\", \"1\", loadOptions);\n      } else {\n        this.library.charts.load(\"current\", loadOptions);\n      }\n    }\n  }\n\n  runCallbacks() {\n    let cb, call;\n    for (let i = 0; i < callbacks.length; i++) {\n      cb = callbacks[i];\n      call = this.library.visualization && ((cb.pack === \"corechart\" && this.library.visualization.LineChart) || (cb.pack === \"timeline\" && this.library.visualization.Timeline));\n      if (call) {\n        cb.callback();\n        callbacks.splice(i, 1);\n        i--;\n      }\n    }\n  }\n\n  // cant use object as key\n  createDataTable(series, columnType, xtype) {\n    let i, j, s, d, key, rows = [], sortedLabels = [];\n    for (i = 0; i < series.length; i++) {\n      s = series[i];\n\n      for (j = 0; j < s.data.length; j++) {\n        d = s.data[j];\n        key = (columnType === \"datetime\") ? d[0].getTime() : d[0];\n        if (!rows[key]) {\n          rows[key] = new Array(series.length);\n          sortedLabels.push(key);\n        }\n        rows[key][i] = toFloat(d[1]);\n      }\n    }\n\n    let rows2 = [];\n    let day = true;\n    let value;\n    for (j = 0; j < sortedLabels.length; j++) {\n      i = sortedLabels[j];\n      if (columnType === \"datetime\") {\n        value = new Date(toFloat(i));\n        day = day && isDay(value);\n      } else if (columnType === \"number\") {\n        value = toFloat(i);\n      } else {\n        value = i;\n      }\n      rows2.push([value].concat(rows[i]));\n    }\n    if (columnType === \"datetime\") {\n      rows2.sort(sortByTime);\n    } else if (columnType === \"number\") {\n      rows2.sort(sortByNumberSeries);\n    }\n\n    if (xtype === \"number\") {\n      rows2.sort(sortByNumberSeries);\n\n      for (i = 0; i < rows2.length; i++) {\n        rows2[i][0] = toStr(rows2[i][0]);\n      }\n    }\n\n    // create datatable\n    let data = new this.library.visualization.DataTable();\n    columnType = columnType === \"datetime\" && day ? \"date\" : columnType;\n    data.addColumn(columnType, \"\");\n    for (i = 0; i < series.length; i++) {\n      data.addColumn(\"number\", series[i].name);\n    }\n    data.addRows(rows2);\n\n    return data;\n  }\n}\n","let pendingRequests = [], runningRequests = 0, maxRequests = 4;\n\nfunction pushRequest(url, success, error) {\n  pendingRequests.push([url, success, error]);\n  runNext();\n}\n\nfunction runNext() {\n  if (runningRequests < maxRequests) {\n    let request = pendingRequests.shift();\n    if (request) {\n      runningRequests++;\n      getJSON(request[0], request[1], request[2]);\n      runNext();\n    }\n  }\n}\n\nfunction requestComplete() {\n  runningRequests--;\n  runNext();\n}\n\nfunction getJSON(url, success, error) {\n  ajaxCall(url, success, function (jqXHR, textStatus, errorThrown) {\n    let message = (typeof errorThrown === \"string\") ? errorThrown : errorThrown.message;\n    error(message);\n  });\n}\n\nfunction ajaxCall(url, success, error) {\n  let $ = window.jQuery || window.Zepto || window.$;\n\n  if ($) {\n    $.ajax({\n      dataType: \"json\",\n      url: url,\n      success: success,\n      error: error,\n      complete: requestComplete\n    });\n  } else {\n    let xhr = new XMLHttpRequest();\n    xhr.open(\"GET\", url, true);\n    xhr.setRequestHeader(\"Content-Type\", \"application/json\");\n    xhr.onload = function () {\n      requestComplete();\n      if (xhr.status === 200) {\n        success(JSON.parse(xhr.responseText), xhr.statusText, xhr);\n      } else {\n        error(xhr, \"error\", xhr.statusText);\n      }\n    };\n    xhr.send();\n  }\n}\n\nexport { pushRequest };\n","import ChartjsAdapter from \"./adapters/chartjs\";\nimport HighchartsAdapter from \"./adapters/highcharts\";\nimport GoogleChartsAdapter from \"./adapters/google\";\n\nimport { merge, isFunction, isArray, toStr, toFloat, toDate, toArr, sortByTime, sortByNumberSeries, isDate } from \"./helpers\";\nimport { pushRequest } from \"./request-queue\";\n\nlet config = (typeof window !== \"undefined\" && window.Chartkick) || {};\nlet adapters = [];\n\n// helpers\n\nfunction setText(element, text) {\n  if (document.body.innerText) {\n    element.innerText = text;\n  } else {\n    element.textContent = text;\n  }\n}\n\nfunction chartError(element, message) {\n  setText(element, \"Error Loading Chart: \" + message);\n  element.style.color = \"#ff0000\";\n}\n\nfunction errorCatcher(chart) {\n  try {\n    chart.__render();\n  } catch (err) {\n    chartError(chart.element, err.message);\n    throw err;\n  }\n}\n\nfunction fetchDataSource(chart, dataSource) {\n  if (typeof dataSource === \"string\") {\n    pushRequest(dataSource, function (data) {\n      chart.rawData = data;\n      errorCatcher(chart);\n    }, function (message) {\n      chartError(chart.element, message);\n    });\n  } else {\n    chart.rawData = dataSource;\n    errorCatcher(chart);\n  }\n}\n\nfunction addDownloadButton(chart) {\n  let element = chart.element;\n  let link = document.createElement(\"a\");\n  link.download = chart.options.download === true ? \"chart.png\" : chart.options.download; // http://caniuse.com/download\n  link.style.position = \"absolute\";\n  link.style.top = \"20px\";\n  link.style.right = \"20px\";\n  link.style.zIndex = 1000;\n  link.style.lineHeight = \"20px\";\n  link.target = \"_blank\"; // for safari\n  let image = document.createElement(\"img\");\n  image.alt = \"Download\";\n  image.style.border = \"none\";\n  // icon from font-awesome\n  // http://fa2png.io/\n  image.src = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAMAAAC6V+0/AAABCFBMVEUAAADMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMywEsqxAAAAV3RSTlMAAQIDBggJCgsMDQ4PERQaHB0eISIjJCouLzE0OTo/QUJHSUpLTU5PUllhYmltcHh5foWLjI+SlaCio6atr7S1t7m6vsHHyM7R2tze5Obo7fHz9ff5+/1hlxK2AAAA30lEQVQYGUXBhVYCQQBA0TdYWAt2d3d3YWAHyur7/z9xgD16Lw0DW+XKx+1GgX+FRzM3HWQWrHl5N/oapW5RPe0PkBu+UYeICvozTWZVK23Ao04B79oJrOsJDOoxkZoQPWgX29pHpCZEk7rEvQYiNSFq1UMqvlCjJkRBS1R8hb00Vb/TajtBL7nTHE1X1vyMQF732dQhyF2o6SAwrzP06iUQzvwsArlnzcOdrgBhJyHa1QOgO9U1GsKuvjUTjavliZYQ8nNPapG6sap/3nrIdJ6bOWzmX/fy0XVpfzZP3S8OJT3g9EEiJwAAAABJRU5ErkJggg==\";\n  link.appendChild(image);\n  element.style.position = \"relative\";\n\n  chart.__downloadAttached = true;\n\n  // mouseenter\n  chart.__enterEvent = addEvent(element, \"mouseover\", function(e) {\n    let related = e.relatedTarget;\n    // check download option again to ensure it wasn't changed\n    if ((!related || (related !== this && !childOf(this, related))) && chart.options.download) {\n      link.href = chart.toImage();\n      element.appendChild(link);\n    }\n  });\n\n  // mouseleave\n  chart.__leaveEvent = addEvent(element, \"mouseout\", function(e) {\n    let related = e.relatedTarget;\n    if (!related || (related !== this && !childOf(this, related))) {\n      if (link.parentNode) {\n        link.parentNode.removeChild(link);\n      }\n    }\n  });\n}\n\n// http://stackoverflow.com/questions/10149963/adding-event-listener-cross-browser\nfunction addEvent(elem, event, fn) {\n  if (elem.addEventListener) {\n    elem.addEventListener(event, fn, false);\n    return fn;\n  } else {\n    let fn2 = function() {\n      // set the this pointer same as addEventListener when fn is called\n      return(fn.call(elem, window.event));\n    };\n    elem.attachEvent(\"on\" + event, fn2);\n    return fn2;\n  }\n}\n\nfunction removeEvent(elem, event, fn) {\n  if (elem.removeEventListener) {\n    elem.removeEventListener(event, fn, false);\n  } else {\n    elem.detachEvent(\"on\" + event, fn);\n  }\n}\n\n// https://gist.github.com/shawnbot/4166283\nfunction childOf(p, c) {\n  if (p === c) return false;\n  while (c && c !== p) c = c.parentNode;\n  return c === p;\n}\n\nfunction getAdapterType(library) {\n  if (library) {\n    if (library.product === \"Highcharts\") {\n      return HighchartsAdapter;\n    } else if (library.setOnLoadCallback || library.charts) {\n      return GoogleChartsAdapter;\n    } else if (isFunction(library)) {\n      return ChartjsAdapter;\n    }\n  }\n  throw new Error(\"Unknown adapter\");\n}\n\nfunction addAdapter(library) {\n  let adapterType = getAdapterType(library);\n  let adapter = new adapterType(library);\n\n  if (adapters.indexOf(adapter) === -1) {\n    adapters.push(adapter);\n  }\n}\n\nfunction loadAdapters() {\n  if (\"Chart\" in window) {\n    addAdapter(window.Chart);\n  }\n\n  if (\"Highcharts\" in window) {\n    addAdapter(window.Highcharts);\n  }\n\n  if (window.google && (window.google.setOnLoadCallback || window.google.charts)) {\n    addAdapter(window.google);\n  }\n}\n\nfunction dataEmpty(data, chartType) {\n  if (chartType === \"PieChart\" || chartType === \"GeoChart\" || chartType === \"Timeline\") {\n    return data.length === 0;\n  } else {\n    for (let i = 0; i < data.length; i++) {\n      if (data[i].data.length > 0) {\n        return false;\n      }\n    }\n    return true;\n  }\n}\n\nfunction renderChart(chartType, chart) {\n  if (chart.options.messages && chart.options.messages.empty && dataEmpty(chart.data, chartType)) {\n    setText(chart.element, chart.options.messages.empty);\n  } else {\n    callAdapter(chartType, chart);\n    if (chart.options.download && !chart.__downloadAttached && chart.adapter === \"chartjs\" && !chart.options.eject) {\n      addDownloadButton(chart);\n    }\n  }\n}\n\n// TODO remove chartType if cross-browser way\n// to get the name of the chart class\nfunction callAdapter(chartType, chart) {\n  let i, adapter, fnName, adapterName;\n  fnName = \"render\" + chartType;\n  adapterName = chart.options.adapter;\n\n  loadAdapters();\n\n  for (i = 0; i < adapters.length; i++) {\n    adapter = adapters[i];\n    if ((!adapterName || adapterName === adapter.name) && isFunction(adapter[fnName])) {\n      chart.adapter = adapter.name;\n      chart.__adapterObject = adapter;\n      return adapter[fnName](chart);\n    }\n  }\n\n  if (adapters.length > 0) {\n    throw new Error(\"No charting library found for \" + chartType);\n  } else {\n    throw new Error(\"No charting libraries found - be sure to include one before your charts\");\n  }\n}\n\n// process data\n\nlet toFormattedKey = function (key, keyType) {\n  if (keyType === \"number\") {\n    key = toFloat(key);\n  } else if (keyType === \"datetime\") {\n    key = toDate(key);\n  } else {\n    key = toStr(key);\n  }\n  return key;\n};\n\nlet formatSeriesData = function (data, keyType) {\n  let r = [], key, j;\n  for (j = 0; j < data.length; j++) {\n    if (keyType === \"bubble\") {\n      r.push([toFloat(data[j][0]), toFloat(data[j][1]), toFloat(data[j][2])]);\n    } else {\n      key = toFormattedKey(data[j][0], keyType);\n      r.push([key, toFloat(data[j][1])]);\n    }\n  }\n  if (keyType === \"datetime\") {\n    r.sort(sortByTime);\n  } else if (keyType === \"number\") {\n    r.sort(sortByNumberSeries);\n  }\n  return r;\n};\n\nlet formatColumnData = function (data) {\n  let parsedData = [];\n\n  Object.keys(data).forEach(key => {\n    if(isDate(data[key])) {\n      parsedData.push(toDate(data[key]));\n    } else {\n      parsedData.push(toFloat(data[key]));\n    }\n  });\n\n  return parsedData;\n};\n\nfunction detectDiscrete(series) {\n  let i, j, data;\n  for (i = 0; i < series.length; i++) {\n    data = toArr(series[i].data);\n    for (j = 0; j < data.length; j++) {\n      if (!isDate(data[j][0])) {\n        return true;\n      }\n    }\n  }\n  return false;\n}\n\n// creates a shallow copy of each element of the array\n// elements are expected to be objects\nfunction copySeries(series) {\n  let newSeries = [], i, j;\n  for (i = 0; i < series.length; i++) {\n    let copy = {};\n    for (j in series[i]) {\n      if (series[i].hasOwnProperty(j)) {\n        copy[j] = series[i][j];\n      }\n    }\n    newSeries.push(copy);\n  }\n  return newSeries;\n}\n\nfunction processSeries(chart, keyType) {\n  let i;\n\n  let opts = chart.options;\n  let series = chart.rawData;\n\n  // see if one series or multiple\n  if (!isArray(series) || typeof series[0] !== \"object\" || isArray(series[0])) {\n    series = [{name: opts.label || \"Value\", data: series}];\n    chart.hideLegend = true;\n  } else {\n    chart.hideLegend = false;\n  }\n  if ((opts.discrete === null || opts.discrete === undefined) && keyType !== \"bubble\" && keyType !== \"number\") {\n    chart.discrete = detectDiscrete(series);\n  } else {\n    chart.discrete = opts.discrete;\n  }\n  if (chart.discrete) {\n    keyType = \"string\";\n  }\n  if (chart.options.xtype) {\n    keyType = chart.options.xtype;\n  }\n\n  // right format\n  series = copySeries(series);\n  for (i = 0; i < series.length; i++) {\n    series[i].data = formatSeriesData(toArr(series[i].data), keyType);\n  }\n\n  return series;\n}\n\nfunction processSimple(chart) {\n  let perfectData = toArr(chart.rawData), i;\n  for (i = 0; i < perfectData.length; i++) {\n    perfectData[i] = [toStr(perfectData[i][0]), toFloat(perfectData[i][1])];\n  }\n  return perfectData;\n}\n\nfunction processCombo(chart) {\n  let perfectData = toArr(chart.rawData), i;\n\n  for (i = 0; i < perfectData.length; i++) {\n    if(i === 0) {\n      let keyList = [];\n\n      Object.keys(perfectData[0]).forEach(key => {\n        keyList.push(key);\n      });  \n\n      perfectData.unshift(keyList);\n      i++;\n    }\n\n    perfectData[i] = formatColumnData(perfectData[i]);\n  }\n\n  return perfectData;\n}\n\n// define classes\n\nclass Chart {\n  constructor(element, dataSource, options) {\n    let elementId;\n    if (typeof element === \"string\") {\n      elementId = element;\n      element = document.getElementById(element);\n      if (!element) {\n        throw new Error(\"No element with id \" + elementId);\n      }\n    }\n    this.element = element;\n    this.options = merge(Chartkick.options, options || {});\n    this.dataSource = dataSource;\n\n    Chartkick.charts[element.id] = this;\n\n    fetchDataSource(this, dataSource);\n\n    if (this.options.refresh) {\n      this.startRefresh();\n    }\n  }\n\n  getElement() {\n    return this.element;\n  }\n\n  getDataSource() {\n    return this.dataSource;\n  }\n\n  getData() {\n    return this.data;\n  }\n\n  getOptions() {\n    return this.options;\n  }\n\n  getChartObject() {\n    return this.chart;\n  }\n\n  getAdapter() {\n    return this.adapter;\n  }\n\n  updateData(dataSource, options) {\n    this.dataSource = dataSource;\n    if (options) {\n      this.__updateOptions(options);\n    }\n    fetchDataSource(this, dataSource);\n  }\n\n  setOptions(options) {\n    this.__updateOptions(options);\n    this.redraw();\n  }\n\n  redraw() {\n    fetchDataSource(this, this.rawData);\n  }\n\n  refreshData() {\n    if (typeof this.dataSource === \"string\") {\n      // prevent browser from caching\n      let sep = this.dataSource.indexOf(\"?\") === -1 ? \"?\" : \"&\";\n      let url = this.dataSource + sep + \"_=\" + (new Date()).getTime();\n      fetchDataSource(this, url);\n    }\n  }\n\n  startRefresh() {\n    let refresh = this.options.refresh;\n\n    if (!this.intervalId) {\n      if (refresh) {\n        this.intervalId = setInterval( () => {\n          this.refreshData();\n        }, refresh * 1000);\n      } else {\n        throw new Error(\"No refresh interval\");\n      }\n    }\n  }\n\n  stopRefresh() {\n    if (this.intervalId) {\n      clearInterval(this.intervalId);\n      this.intervalId = null;\n    }\n  }\n\n  toImage() {\n    if (this.adapter === \"chartjs\") {\n      return this.chart.toBase64Image();\n    } else {\n      return null;\n    }\n  }\n\n  destroy() {\n    if (this.__adapterObject) {\n      this.__adapterObject.destroy(this);\n    }\n\n    if (this.__enterEvent) {\n      removeEvent(this.element, \"mouseover\", this.__enterEvent);\n    }\n\n    if (this.__leaveEvent) {\n      removeEvent(this.element, \"mouseout\", this.__leaveEvent);\n    }\n  }\n\n  __updateOptions(options) {\n    let updateRefresh = options.refresh && options.refresh !== this.options.refresh;\n    this.options = merge(Chartkick.options, options);\n    if (updateRefresh) {\n      this.stopRefresh();\n      this.startRefresh();\n    }\n  }\n\n  __render() {\n    this.data = this.__processData();\n    renderChart(this.__chartName(), this);\n  }\n\n  __config() {\n    return config;\n  }\n}\n\nclass LineChart extends Chart {\n  __processData() {\n    return processSeries(this, \"datetime\");\n  }\n\n  __chartName() {\n    return \"LineChart\";\n  }\n}\n\nclass PieChart extends Chart {\n  __processData() {\n    return processSimple(this);\n  }\n\n  __chartName() {\n    return \"PieChart\";\n  }\n}\n\nclass ColumnChart extends Chart {\n  __processData() {\n    return processSeries(this, \"string\");\n  }\n\n  __chartName() {\n    return \"ColumnChart\";\n  }\n}\n\nclass BarChart extends Chart {\n  __processData() {\n    return processSeries(this, \"string\");\n  }\n\n  __chartName() {\n    return \"BarChart\";\n  }\n}\n\nclass AreaChart extends Chart {\n  __processData() {\n    return processSeries(this, \"datetime\");\n  }\n\n  __chartName() {\n    return \"AreaChart\";\n  }\n}\n\nclass GeoChart extends Chart {\n  __processData() {\n    return processSimple(this);\n  }\n\n  __chartName() {\n    return \"GeoChart\";\n  }\n}\n\nclass ScatterChart extends Chart {\n  __processData() {\n    return processSeries(this, \"number\");\n  }\n\n  __chartName() {\n    return \"ScatterChart\";\n  }\n}\n\nclass BubbleChart extends Chart {\n  __processData() {\n    return processSeries(this, \"bubble\");\n  }\n\n  __chartName() {\n    return \"BubbleChart\";\n  }\n}\n\nclass Timeline extends Chart {\n  __processData() {\n    let i, data = this.rawData;\n    for (i = 0; i < data.length; i++) {\n      data[i][1] = toDate(data[i][1]);\n      data[i][2] = toDate(data[i][2]);\n    }\n    return data;\n  }\n\n  __chartName() {\n    return \"Timeline\";\n  }\n}\n\nclass ComboChart extends Chart {\n  __processData() {\n    return processCombo(this);\n  }\n\n  __chartName() {\n    return \"ComboChart\";\n  }\n}\n\nclass PolarChart extends Chart {\n  __processData() {\n    return processSeries(this, \"polar\");\n  }\n\n  __chartName() {\n    return \"PolarChart\";\n  }\n}\n\nconst Chartkick = {\n  LineChart: LineChart,\n  PieChart: PieChart,\n  ColumnChart: ColumnChart,\n  BarChart: BarChart,\n  AreaChart: AreaChart,\n  GeoChart: GeoChart,\n  ScatterChart: ScatterChart,\n  BubbleChart: BubbleChart,\n  Timeline: Timeline,\n  ComboChart: ComboChart,\n  PolarChart: PolarChart,\n  charts: {},\n  configure: function (options) {\n    for (let key in options) {\n      if (options.hasOwnProperty(key)) {\n        config[key] = options[key];\n      }\n    }\n  },\n  eachChart: function (callback) {\n    for (let chartId in Chartkick.charts) {\n      if (Chartkick.charts.hasOwnProperty(chartId)) {\n        callback(Chartkick.charts[chartId]);\n      }\n    }\n  },\n  config: config,\n  options: {},\n  adapters: adapters,\n  addAdapter: addAdapter\n};\n\nexport default Chartkick;\n"],"names":["isArray","variable","Object","prototype","toString","call","isFunction","Function","isPlainObject","extend","target","source","let","key","undefined","merge","obj1","obj2","DATE_PATTERN","ISO8601_PATTERN","DECIMAL_SEPARATOR","String","charAt","toStr","n","toFloat","parseFloat","toDate","matches","year","month","day","Date","match","parseInt","input","hour","milliseconds","minutes","offset","result","seconds","type","slice","UTC","parseISO8601","replace","toArr","i","arr","hasOwnProperty","push","jsOptionsFunc","defaultOptions","hideLegend","setTitle","setMin","setMax","setStacked","setXtitle","setYtitle","chart","opts","chartOptions","series","data","options","legend","title","min","j","length","negativeValues","max","stacked","colors","xtitle","ytitle","library","sortByTime","a","b","getTime","sortByNumberSeries","sortByNumber","isMinute","d","getMilliseconds","getSeconds","isHour","getMinutes","isDay","getHours","isWeek","dayOfWeek","getDay","isMonth","getDate","isYear","getMonth","isDate","obj","isNaN","formatValue","pre","value","prefix","thousands","decimal","parts","split","suffix","baseOptions","maintainAspectRatio","animation","tooltips","displayColors","callbacks","fontSize","fontColor","scales","yAxes","ticks","maxTicksLimit","scaleLabel","xAxes","gridLines","drawOnChartArea","time","defaultColors","display","position","text","setBarMin","setBarMax","labelString","addOpacity","hex","opacity","exec","setFormatOptions","chartType","formatOptions","myAxes","callback","label","valueLabel","tooltipItem","datasets","datasetIndex","dataLabel","labels","index","jsOptions","createDataTable","s","week","minute","detectType","discrete","sortedLabels","rows","Array","indexOf","xtype","sort","k","rows2","color","backgroundColor","dataset","name","fill","borderColor","pointBackgroundColor","pointHoverBackgroundColor","borderWidth","stack","curve","lineTension","points","pointRadius","pointHitRadius","minTime","maxTime","step","timeDiff","unit","displayFormats","unitStepSize","Math","ceil","element","offsetWidth","tooltipFormat","this","defaultExport","renderLineChart","renderScatterChart","allZeros","drawChart","renderPieChart","donut","cutoutPercentage","values","point","renderColumnChart","maxLabelSize","substring","setLabelSize","renderAreaChart","renderBarChart","lineChart","x","y","r","showLine","renderBubbleChart","renderPolarChart","keys","rawData","forEach","destroy","eject","innerText","JSON","stringify","innerHTML","ctx","getElementsByTagName","xAxis","style","yAxis","credits","enabled","tooltip","plotOptions","areaspline","marker","verticalAlign","layout","align","stacking","formatter","pointFormatter","area","symbol","pie","innerSize","categories","d2","newSeries","renderTo","id","Chart","loaded","chartArea","fontName","pointSize","textStyle","alignment","curveType","hAxis","titleTextStyle","gridlines","baselineColor","viewWindow","vAxis","isStacked","italic","waitForLoaded","columnType","this$1","top","height","pieHole","visualization","DataTable","addColumn","addRows","areaOpacity","renderGeoChart","colorAxis","row","renderTimeline","lineHeight","renderComboChart","vAxes","0","viewWindowMode","1","format","seriesType","targetAxisIndex","arrayToDataTable","clearChart","toJSON","draw","window","attachEvent","addEventListener","pack","runCallbacks","loadOptions","packages","config","__config","language","mapsApiKey","setOnLoadCallback","load","charts","cb","LineChart","Timeline","splice","concat","pendingRequests","runningRequests","maxRequests","runNext","request","shift","url","success","error","$","jQuery","Zepto","ajax","dataType","complete","requestComplete","xhr","XMLHttpRequest","open","setRequestHeader","onload","status","parse","responseText","statusText","send","ajaxCall","jqXHR","textStatus","errorThrown","message","Chartkick","adapters","setText","document","body","textContent","chartError","errorCatcher","__render","err","fetchDataSource","dataSource","addEvent","elem","event","fn","fn2","removeEvent","removeEventListener","detachEvent","childOf","p","c","parentNode","addAdapter","adapter","product","HighchartsAdapter","GoogleChartsAdapter","ChartjsAdapter","Error","getAdapterType","renderChart","messages","empty","dataEmpty","fnName","adapterName","Highcharts","google","__adapterObject","callAdapter","download","__downloadAttached","link","createElement","right","zIndex","image","alt","border","src","appendChild","__enterEvent","e","related","relatedTarget","href","toImage","__leaveEvent","removeChild","addDownloadButton","toFormattedKey","keyType","formatSeriesData","formatColumnData","parsedData","processSeries","detectDiscrete","copy","copySeries","processSimple","perfectData","elementId","getElementById","refresh","startRefresh","getElement","getDataSource","getData","getOptions","getChartObject","getAdapter","updateData","__updateOptions","setOptions","redraw","refreshData","sep","intervalId","setInterval","stopRefresh","clearInterval","toBase64Image","updateRefresh","__processData","__chartName","PieChart","ColumnChart","BarChart","AreaChart","GeoChart","ScatterChart","BubbleChart","ComboChart","keyList","unshift","processCombo","PolarChart","configure","eachChart","chartId"],"mappings":"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"}